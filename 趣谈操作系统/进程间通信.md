## 1 进程间通信

### 1.1 管道模型

```c
ps -ef | grep 关键字 | awk '{print $2}' | xargs kill -9
```

这里面的竖线`|`就是一个管道。它会**将前一个命令的输出，作为后一个命令的输入**。

从管道的这个名称可以看出来，**管道是一种单向传输数据的机制**，它其实是一段缓存，里面的数据只能从一端写入，从另一端读出。**如果想互相通信，我们需要创建两个管道才行**。

**1、管道的两种类型**

- **匿名管道**

  - 没有名字，用完就销毁了

- **命名管道**

  - 需要通过`mkfifo`命令创建，管道以文件的形式存在，文件类型是p

    ```c
    # hello是管道的名称
    mkfifo hello
    ```

  - 写入字符串，输入完命令之后命令会停住，**需要读取才能结束**

    ```c
    echo "hello world" > hello
    ```

### 1.2 消息队列模型

<img src="https://img-blog.csdnimg.cn/83f4f3b6b40f47a9a5c035471e6d0e90.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NjUwODk5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" style="zoom:50%;" />

消息队列是保存在**内核**中的消息链表，**会涉及到用户态跟内核态到来回切换**，双方约定好消息体到数据结构，然后发送数据时将数据分成一个个独立的数据单元消息体，需注意消息队列及单个消息都有上限。

### 1.3 共享内存模型

现代操作系统对内存管理采用的是虚拟内存技术，也就是每个进程都有自己独立的虚拟内存空间，不同进程的虚拟内存映射到不同的物理内存中。**所以，即使进程A和进程B虚拟地址是一样的，真正访问的也是不同的物理内存地址**

该模式不涉及到用户态跟内核态来回切换，JVM 就是用的共享内存模式。并且并发编程也是个难点。

### 1.4 信号量

1、如果多个进程使用同一个共享内存就会产生冲突，所以需要一个保护机制；**在System V IPC进程间通信机制体系中使用信号量**，因此，信号量和共享内存需要配合使用

2、信号量其实是一个**计数器**，用于实现进程间的互斥和同步

- **P操作**：申请资源，将信号量的数值减去N，表示资源被申请了，其他人不能使用
- **V操作**：归还资源，将信号量加上M，表示归还资源，其他人可以使用

### 1.5 信号

1、Linux提供了几十种信号，分别代表不同的意义，信号之间依靠他们的值来区分

2、信号可以在任何时候发送给某个进程，进程需要为信号配置信号处理函数

**3、信号是进程间通信机制中唯一的异步通信机制，可以在任何时候发送信号给某个进程**

- kill -9 1412：表示pid为1412的进程发送SIGKILL信号，用来立即结束该进程
- Ctrl+C：表示SIGINT信号，表示终止该进程

4、有信号发生时，进程一般有三种方式响应：

- 执行默认操作
- 捕捉信号
- 忽略信号

### 1.6 Socket

1、跨网络与不同主机上的进程之间通信

2、可以指定IPV4、IPV6、TCP、UDP类型，比如TCP协议通信的Socket模型如下：

<img src="https://img-blog.csdnimg.cn/42d48c4a85244f998b9e1e2c63cea4a2.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NjUwODk5,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" style="zoom:50%;" />



## 2 管道





































